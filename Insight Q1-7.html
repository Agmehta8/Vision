<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title></title>
  <style>
    /* Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    /* Base styles */
    body {
      min-height: 100vh;
      background-color: #f7f6f3; /* warm off-white */
      color: #2f2f2f; /* soft charcoal */
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Layout container */
    .container {
      text-align: center;
      max-width: 520px;
      width: 100%;
      padding: 2.5rem 1.5rem 3.5rem;
    }

    .dashboard-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .dashboard-copy {
      text-align: left;
      flex: 1;
    }

    .app-name {
      font-size: 2.2rem;
      font-weight: 500;
      margin-bottom: 0.6rem;
      letter-spacing: 0.01em;
    }

    .intro-line {
      font-size: 1.1rem;
      line-height: 1.6;
      color: #4a4a4a;
    }

    .progress-ring {
      width: 86px;
      height: 86px;
    }

    .progress-ring circle {
      fill: none;
      stroke-width: 8;
    }

    .progress-ring .track {
      stroke: #e2e0db;
    }

    .progress-ring .progress {
      stroke: #8fa6a0;
      stroke-linecap: round;
      transition: stroke-dashoffset 300ms ease;
    }

    .progress-label {
      font-size: 0.9rem;
      fill: #2f2f2f;
      font-weight: 600;
    }

    .assessment-list {
      list-style: none;
      display: grid;
      gap: 1rem;
    }

    .assessment-card {
      background: #ffffff;
      border-radius: 18px;
      padding: 1.25rem 1.5rem;
      text-align: left;
      box-shadow: 0 10px 24px rgba(47, 47, 47, 0.08);
      border: 1px solid transparent;
      display: flex;
      align-items: center;
      gap: 1rem;
      cursor: pointer;
      transition: transform 300ms ease, box-shadow 300ms ease, border-color 300ms ease;
    }

    .assessment-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 14px 28px rgba(47, 47, 47, 0.12);
    }

    .assessment-card.completed {
      background: rgba(143, 166, 160, 0.15);
    }


    .status-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: color 400ms ease-in-out;
      color: #b5b5b0;
    }

    .status-icon svg {
      width: 100%;
      height: 100%;
    }

    .status-icon .bullseye-outer,
    .status-icon .bullseye-inner {
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
      transition: stroke 400ms ease-in-out, fill 400ms ease-in-out;
    }

    .status-icon.status-answered {
      color: #5fbf6f;
    }

    .status-icon.status-answered .bullseye-inner {
      fill: currentColor;
    }


    .card-meta {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .card-category {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #8fa6a0;
      font-weight: 600;
    }

    .card-question {
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .topic-link {
      display: inline-block;
      margin-top: 2.5rem;
      text-decoration: none;
      color: #4a4a4a;
      font-size: 0.95rem;
    }

    .focus-overlay {
      position: fixed;
      inset: 0;
      background: rgba(247, 246, 243, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: opacity 300ms ease, transform 300ms ease;
      padding: 2rem 1.5rem;
      z-index: 10;
    }

    .focus-overlay.active {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .focus-card {
      background: #ffffff;
      border-radius: 22px;
      max-width: 560px;
      width: 100%;
      padding: 2rem;
      box-shadow: 0 20px 40px rgba(47, 47, 47, 0.12);
      display: grid;
      gap: 1.5rem;
      transition: background-color 400ms ease, box-shadow 400ms ease, transform 400ms ease;
    }

    .focus-header {
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }


    .focus-category {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #8fa6a0;
      font-weight: 600;
    }

    .focus-question {
      font-size: 1.25rem;
      line-height: 1.6;
      text-align: left;
    }

    .options-grid {
      display: grid;
      gap: 0.75rem;
    }

    .options-row {
      display: grid;
      grid-auto-flow: column;
      gap: 0.75rem;
    }

    .option-tile {
      border: 1.5px solid #d3d3cf;
      border-radius: 16px;
      padding: 0.9rem 1rem;
      font-size: 0.98rem;
      line-height: 1.4;
      background: #ffffff;
      text-align: left;
      cursor: pointer;
      opacity: 1;
      transition: border-color 450ms cubic-bezier(0.4, 0, 0.2, 1),
        border-width 450ms cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 450ms cubic-bezier(0.4, 0, 0.2, 1),
        opacity 450ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .option-tile strong {
      font-weight: 600;
    }

    .option-tile.selected {
      border-color: #5fbf6f;
      border-width: 2.5px;
      background: rgba(95, 191, 111, 0.12);
      box-shadow: 0 8px 18px rgba(95, 191, 111, 0.2);
    }

    .option-tile.faded {
      opacity: 0.35;
    }

    .secondary-options {
      margin-top: 0.5rem;
    }

    .secondary-label {
      font-size: 0.85rem;
      color: #6f6f6b;
      margin-bottom: 0.5rem;
      text-align: left;
    }

    @media (max-width: 540px) {
      .dashboard-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .progress-ring {
        align-self: flex-end;
      }

      .focus-card {
        padding: 1.5rem;
      }

      .options-row {
        grid-auto-flow: row;
      }

    }
  </style>
</head>
<body>
  <main class="container">
    <section class="dashboard" aria-live="polite">
      <header class="dashboard-header">
        <div class="dashboard-copy">
        </div>
        <svg class="progress-ring" viewBox="0 0 100 100" aria-label="Progress">
          <circle class="track" cx="50" cy="50" r="36"></circle>
          <circle class="progress" cx="50" cy="50" r="36" stroke-dasharray="226" stroke-dashoffset="226"></circle>
          <text class="progress-label" x="50" y="56" text-anchor="middle">0%</text>
        </svg>
      </header>

      <ol class="assessment-list" id="assessmentList"></ol>

      <a href="questions.html" class="topic-link">Back to Questions</a>
    </section>
  </main>

  <section class="focus-overlay" id="focusOverlay" aria-hidden="true">
    <div class="focus-card" role="dialog" aria-modal="true">
      <header class="focus-header">
      </header>
      <div>
        <p class="focus-category" id="focusCategory"></p>
        <h2 class="focus-question" id="focusQuestion"></h2>
      </div>
      <div id="optionsContainer"></div>
    </div>
  </section>

  <script>
    const questions = [
      {
        id: "q1",
        category: "Status",
        question: "What stage is your cancer?",
        options: [
          "No evidence of cancer",
          "Early stage of cancer",
          "Middle stage of cancer",
          "Late stage of cancer",
          "End stage of cancer",
          "Do not know"
        ]
      },
      {
        id: "q2",
        category: "Provider Perspective",
        question: "Which of the following best represents what your oncology providers have told you about a cure for your cancer?",
        options: [
          "<strong>My cancer will be cured</strong>",
          "<strong>My cancer may be cured</strong> if treatments are successful",
          "<strong>My cancer cannot be cured</strong> but we will try to control the cancer with treatment",
          "<strong>My cancer cannot be cured</strong> and I am not able to have any additional cancer treatment",
          "Do not know"
        ]
      },
      {
        id: "q3",
        category: "Patient Perspective",
        question: "Which of the following best represents what you think about a cure for your cancer?",
        options: [
          "<strong>My cancer will be cured</strong>",
          "<strong>My cancer may be cured</strong> if treatments are successful",
          "<strong>My cancer cannot be cured</strong> but we will try to control the cancer with treatment",
          "<strong>My cancer cannot be cured</strong> and I am not able to have any additional cancer treatment",
          "Do not know"
        ]
      },
      {
        id: "q4",
        category: "Prognosis Info",
        question: "What have your oncology providers told you about how long you are expected to live (your prognosis)?",
        ui_type: "timeline",
        options: ["Weeks", "Months", "Years", "Decades"],
        secondary_options: [
          "We have discussed this, but I have not received a clear answer",
          "We have not discussed this"
        ]
      },
      {
        id: "q5",
        category: "Patient Prognosis",
        question: "At this moment, how long do you think you will live?",
        ui_type: "timeline",
        options: ["Weeks", "Months", "Years", "Decades"],
        secondary_options: ["I do not know", "I do not want to think about this"]
      },
      {
        id: "q6",
        category: "Health Status",
        question: "How would you describe your current health status?",
        options: [
          "Relatively healthy",
          "Relatively healthy and terminally ill",
          "Seriously ill but not terminally ill",
          "Seriously ill and terminally ill",
          "Do not know"
        ]
      }
    ];

    const state = questions.map(() => ({ status: "unanswered", answer: null }));
    const assessmentList = document.getElementById("assessmentList");
    const focusOverlay = document.getElementById("focusOverlay");
    const focusCategory = document.getElementById("focusCategory");
    const focusQuestion = document.getElementById("focusQuestion");
    const optionsContainer = document.getElementById("optionsContainer");
    const progressRing = document.querySelector(".progress-ring .progress");
    const progressLabel = document.querySelector(".progress-ring .progress-label");
    const focusCard = document.querySelector(".focus-card");

    let activeIndex = 0;
    let navigationTimeoutId = null;

    function renderDashboard() {
      assessmentList.innerHTML = "";
      questions.forEach((item, index) => {
        const card = document.createElement("li");
        const isAnswered = state[index].status === "completed";
        card.className = `assessment-card ${state[index].status}`.trim();
        card.dataset.questionId = item.id;
        card.innerHTML = `
          <span class="status-icon${isAnswered ? " status-answered" : ""}">${statusIcon()}</span>
          <div class="card-meta">
            <span class="card-category">${item.category}</span>
            <span class="card-question">${item.question}</span>
          </div>
        `;
        card.addEventListener("click", () => openFocus(index));
        assessmentList.appendChild(card);
      });
      updateProgress();
    }

    function statusIcon() {
      return `
        <svg class="bullseye" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <circle class="bullseye-outer" cx="12" cy="12" r="9"></circle>
          <circle class="bullseye-inner" cx="12" cy="12" r="4"></circle>
        </svg>
      `;
    }

    function updateProgress() {
      const completedCount = state.filter(item => item.status === "completed").length;
      const percent = Math.round((completedCount / questions.length) * 100);
      const circumference = 2 * Math.PI * 36;
      progressRing.style.strokeDasharray = circumference;
      progressRing.style.strokeDashoffset = circumference - (percent / 100) * circumference;
      progressLabel.textContent = `${percent}%`;
    }

    function openFocus(index) {
      activeIndex = index;
      const item = questions[index];
      focusCategory.textContent = item.category;
      focusQuestion.textContent = item.question;
      focusCard.dataset.questionId = item.id;
      renderOptions(item, state[index].answer);
      focusOverlay.classList.add("active");
      focusOverlay.setAttribute("aria-hidden", "false");
    }

    function closeFocus() {
      focusOverlay.classList.remove("active");
      focusOverlay.setAttribute("aria-hidden", "true");
      renderDashboard();
    }

    function renderOptions(item, selectedAnswer) {
      optionsContainer.innerHTML = "";
      const optionsWrapper = document.createElement("div");
      const primaryOptions = document.createElement("div");
      primaryOptions.className = item.ui_type === "timeline" ? "options-row" : "options-grid";

      item.options.forEach(option => {
        const button = document.createElement("button");
        button.type = "button";
        button.className = "option-tile";
        button.dataset.value = option;
        button.innerHTML = option;
        button.addEventListener("click", (event) => selectOption(option, event));
        primaryOptions.appendChild(button);
      });

      optionsWrapper.appendChild(primaryOptions);

      if (item.secondary_options) {
        const secondaryWrapper = document.createElement("div");
        secondaryWrapper.className = "secondary-options";
        secondaryWrapper.innerHTML = '<p class="secondary-label">If none of these fit, choose one of these:</p>';
        const secondaryOptions = document.createElement("div");
        secondaryOptions.className = "options-grid";
        item.secondary_options.forEach(option => {
          const button = document.createElement("button");
          button.type = "button";
          button.className = "option-tile";
          button.dataset.value = option;
          button.textContent = option;
          button.addEventListener("click", (event) => selectOption(option, event));
          secondaryOptions.appendChild(button);
        });
        secondaryWrapper.appendChild(secondaryOptions);
        optionsWrapper.appendChild(secondaryWrapper);
      }

      applyFocusFade(optionsWrapper, selectedAnswer);
      optionsContainer.appendChild(optionsWrapper);
    }

    function applyFocusFade(container, selectedValue) {
      const optionTiles = container.querySelectorAll(".option-tile");
      optionTiles.forEach(tile => {
        const isSelected = selectedValue && tile.dataset.value === selectedValue;
        tile.classList.toggle("selected", isSelected);
        tile.classList.toggle("faded", Boolean(selectedValue) && !isSelected);
      });
    }

    function findClosestBullseye(trigger) {
      const focusContainer = trigger.closest(".focus-card");
      if (!focusContainer) return null;
      const questionId = focusContainer.dataset.questionId;
      return document.querySelector(
        `.assessment-card[data-question-id="${questionId}"] .status-icon`
      );
    }

    function updateBullseyeStatus(trigger, isAnswered) {
      const statusIcon = findClosestBullseye(trigger);
      if (!statusIcon) return;
      statusIcon.classList.toggle("status-answered", isAnswered);
    }

    function scrollToNextQuestion(currentIndex) {
      const nextIndex = currentIndex + 1;
      const nextQuestion = questions[nextIndex];
      if (!nextQuestion) {
        return;
      }
      const nextCard = document.querySelector(
        `.assessment-card[data-question-id="${nextQuestion.id}"]`
      );
      if (nextCard) {
        nextCard.scrollIntoView({ behavior: "smooth", block: "center" });
      }
    }

    function selectOption(option, event) {
      const trigger = event.currentTarget;
      const isSameSelection = state[activeIndex].answer === option;
      if (isSameSelection) {
        if (navigationTimeoutId) {
          clearTimeout(navigationTimeoutId);
          navigationTimeoutId = null;
        }
        state[activeIndex].answer = null;
        state[activeIndex].status = "unanswered";
        renderOptions(questions[activeIndex], null);
        updateBullseyeStatus(trigger, false);
        renderDashboard();
        return;
      }

      if (navigationTimeoutId) {
        clearTimeout(navigationTimeoutId);
      }
      state[activeIndex].answer = option;
      state[activeIndex].status = "completed";
      renderOptions(questions[activeIndex], option);
      updateBullseyeStatus(trigger, true);
      navigationTimeoutId = setTimeout(() => {
        closeFocus();
        scrollToNextQuestion(activeIndex);
      }, 1000);
    }

    renderDashboard();
  </script>
</body>
</html>
